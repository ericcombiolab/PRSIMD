# PRSIMD: Disease risk prediction by polygenic risk score integrating multi-type data

## Polygenic risk score derivation
### UK biobank genetic data
[Genetic profiles](https://biobank.ndph.ox.ac.uk/ukb/ukb/docs/ukbgene_instruct.html#dag)
### Genome-wide association studies (GWAS) summary statistics

### LDpred2
Refer to [privefl's work](https://github.com/privefl/paper-ldpred2/tree/master/code)

## Multi-type data matrix
#### Columns description

## Code Environment
Code is tested using Python 3.8.8 and Pytorch 1.9.0

## Train model
#### Python script: PRSIMD_diseaseXX.py
Example of the command line:
``` bash
$ python PRSIMD_cad.py  
Data loading succeed
train or evaluation mode?       train
```
Example output (Dir: result):
+ auc_collected.txt: columns - $\alpha$ , $\beta$ , AUROC.
+ loss/: train loss and val loss in each epoch.
+ param/: the trained network weights (parameters).
    
## Evaluate model
#### Python script: PRSIMD_diseaseXX.py
Check the auc_collected.txt file generated by training step and find the best $\alpha$ , $\beta$.

Example of the command line:
``` bash
$ python PRSIMD_cad.py  
Data loading succeed
train or evaluation mode?       evaluation
alpha select(1,0.1,0.05,0.01,0.005)     1
beta select(1,0.1,0.05,0.01,0.005)      1
save result?(yes/no)    yes
```
Example output (Dir: result):
+ y_pred.txt: test set predicted values(scores).
+ y_test.txt: test set labels.

## Contact  
If any question, please feel free to contact with me or my supervisor Dr.Eric Zhang   
(Yu XU, email: csyuxu@comp.hkbu.edu.hk)  
(Lu Zhang, email: ericluzhang@hkbu.edu.hk) 
